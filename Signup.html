<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register - Real Estate Portal</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
* { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background: linear-gradient(135deg, #f3f4f6, #e0e7ff); display:flex; justify-content:center; align-items:center; min-height:100vh; padding:20px; }
.container { display:flex; flex-direction:column; width:100%; max-width:650px; background:#fff; border-radius:15px; box-shadow:0 15px 40px rgba(0,0,0,0.2); overflow:hidden; padding:20px; }
.left-panel { background: linear-gradient(135deg, #a5b4fc, #818cf8); color:#fff; padding:25px 20px; text-align:center; border-radius: 10px 10px 0 0; }
.left-panel h2 { font-size: 1.8rem; margin-bottom: 10px; }
.left-panel p { font-size: 1rem; line-height: 1.4; margin-bottom: 15px; }
.left-panel i { font-size: 3rem; }
.right-panel { padding: 25px 20px; opacity: 0; transform: translateY(20px); animation: fadeIn 1.5s forwards; animation-delay: 0.5s; }
.right-panel h2 { color: #1e3a8a; text-align:center; margin-bottom:20px; font-size:1.6rem; }
@keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
.form-group { position:relative; margin-bottom:15px; }
.form-group input, .form-group select { width:100%; padding:10px 12px; border:1px solid #cbd5e1; border-radius:5px; font-size:14px; }
.form-group label { display:block; margin-bottom:5px; color:#374151; font-size:14px; }
.btn { width:100%; padding:12px; background: linear-gradient(135deg, #6366f1, #818cf8); border:none; border-radius:8px; color:#fff; font-weight:bold; cursor:pointer; font-size:16px; }
.btn:hover { opacity:0.9; transform:translateY(-1px); }
.message { margin-bottom:15px; padding:10px; border-radius:5px; text-align:center; font-weight:bold; display:none; }
.message.success { background:#d1fae5; color:#065f46; }
.message.error { background:#fee2e2; color:#991b1b; }
@media (max-width:768px) { .container { max-width:100%; } }
</style>
</head>
<body>

<div class="container">
    <div class="left-panel">
        <h2>Welcome!</h2>
        <p>Join our portal to find your dream property or list your property. Connect safely with landlords and tenants.</p>
        <i class="fas fa-home"></i>
    </div>

    <div class="right-panel">
        <h2>Create Account</h2>
        <div id="formMessage" class="message"></div>
        <form id="registrationForm">
            <div class="form-group">
                <label for="firstname">First Name</label>
                <input type="text" id="firstname" placeholder="Enter first name" required>
            </div>
            <div class="form-group">
                <label for="surname">Surname</label>
                <input type="text" id="surname" placeholder="Enter surname" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" placeholder="Enter phone number" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="Enter email" required>
            </div>
            <div class="form-group">
                <label for="idnumber">ID Number</label>
                <input type="text" id="idnumber" placeholder="Enter ID number" required>
            </div>
            <div class="form-group">
                <label for="gender">Gender</label>
                <select id="gender" required>
                    <option value="" disabled selected>Select Gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>
            <div class="form-group">
                <label for="user_type">Register as</label>
                <select id="user_type" required>
                    <option value="" disabled selected>Select Role</option>
                    <option value="tenant">Tenant</option>
                    <option value="landlord">Landlord</option>
                </select>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter password" required>
            </div>
            <button type="submit" class="btn">Register Now</button>
        </form>
    </div>
</div>

<script>
const form = document.getElementById('registrationForm');
const formMessage = document.getElementById('formMessage');

form.addEventListener('submit', function(e) {
    e.preventDefault();

    // Gather form values
    const data = {
        firstname: document.getElementById('firstname').value.trim(),
        surname: document.getElementById('surname').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        email: document.getElementById('email').value.trim(),
        idnumber: document.getElementById('idnumber').value.trim(),
        gender: document.getElementById('gender').value,
        user_type: document.getElementById('user_type').value,
        password: document.getElementById('password').value
    };

    fetch('/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(response => {
        formMessage.style.display = 'block';
        if(response.success) {
            formMessage.className = 'message success';
            formMessage.innerText = response.message;
            setTimeout(() => window.location.href = '/index.html', 2000);
        } else {
            formMessage.className = 'message error';
            if(response.errors) formMessage.innerText = response.errors[0].msg;
            else formMessage.innerText = response.message;
        }
    })
    .catch(err => {
        console.error(err);
        formMessage.style.display = 'block';
        formMessage.className = 'message error';
        formMessage.innerText = 'An error occurred. Please try again.';
    });
});
</script>
</body>
</html>
